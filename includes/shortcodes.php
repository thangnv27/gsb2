<?phpfunction get_most_video(){    $loop = new WP_Query(array(                'post_type' => 'post',                'posts_per_page' => 5,                'tax_query' => array(                    array(                        'taxonomy' => 'post_format',                        'field' => 'slug',                        'terms' => array('post-format-video')                    )                ),                'meta_query' => array(                    array(                        'key' => 'is_most',                        'value' => '1',                    )                ),            ));    $html = '<div class="home-news fr ml10" style="display:block;"><div class="rbox-title"><h3>VIDEO NỔI BẬT</h3></div><div class="rbox-content"><ul>';    while ($loop->have_posts()) : $loop->the_post();        $html .= '<li><a href="' . get_permalink() . '" title="' . get_the_title() . '">' . get_short_content(get_the_title(), 46) . '</a></li>';    endwhile;    wp_reset_query();    $html .= '</ul></div></div>';    return $html;}function get_most_news(){    $loop = new WP_Query(array(                'post_type' => 'post',                'posts_per_page' => 5,                'tax_query' => array(                    array(                        'taxonomy' => 'post_format',                        'field' => 'slug',                        'terms' => array('post-format-video'),                        'operator' => 'NOT IN'                    )                ),                'meta_query' => array(                    array(                        'key' => 'is_most',                        'value' => '1',                    )                ),            ));    $html = '<div class="home-news fr ml10" style="display:block;"><div class="rbox-title"><h3>TIN TỨC NỔI BẬT</h3></div><div class="rbox-content"><ul>';    while ($loop->have_posts()) : $loop->the_post();        $html .= '<li><a href="' . get_permalink() . '" title="' . get_the_title() . '">' . get_short_content(get_the_title(), 46) . '</a></li>';    endwhile;    wp_reset_query();    $html .= '</ul></div></div>';    return $html;}add_shortcode('videoblock', 'shortcode_videoblock');add_shortcode('newsblock', 'shortcode_newsblock');function shortcode_videoblock($atts, $content = null) {    return get_most_video();}function shortcode_newsblock($atts, $content = null) {    return get_most_news();}//////////////////////////////////////////////////////////////////// Add buttons to tinyMCE//////////////////////////////////////////////////////////////////add_action('init', 'add_button');function add_button() {    if (current_user_can('edit_posts') && current_user_can('edit_pages')) {        add_filter('mce_external_plugins', 'add_plugin');        add_filter('mce_buttons_3', 'register_button');    }}function register_button($buttons) {    array_push($buttons, "videoblock", "newsblock");    return $buttons;}function add_plugin($plugin_array) {    $plugin_array['videoblock'] = get_template_directory_uri() . '/tinymce/customcodes.js';    $plugin_array['newsblock'] = get_template_directory_uri() . '/tinymce/customcodes.js';    return $plugin_array;}?>